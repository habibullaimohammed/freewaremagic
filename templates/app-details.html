{% include 'base.html'%}

<div class="container">
    <div class="row">
        <div class="col-lg-9">
            <div class="row align-items-center">
                <div class="">
                    <img width="100" height="100"
                         src="https://images.sftcdn.net/images/t_app-icon-m/p/3e3e237f-1ec0-428e-a714-7281e181311e/235315164/ssuite-netsurfer-browser-SSuite%20NetSurfer%20Browser-icon.png">
                    <h3 class="mx-3 d-inline">{{app_details.title}}</h3>
                </div>
                <div>
                    <a class="btn btn-dark w-100"
                       href="/android/edit-android-apps/{{app_details.title|replace(' ', '-')}}" target="_self">Edit</a>
                </div>
                <div>
                    <!-- Add a button to increase the download count -->
                    <a id="increaseDownloadButton" class="btn btn-success mt-2 w-100">Increase Download Count</a>
                </div>
            </div>
            <nav class="mt-5">
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home"
                            type="button" role="tab" aria-controls="nav-home" aria-selected="true">Description
                    </button>
                    <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile"
                            type="button" role="tab" aria-controls="nav-profile" aria-selected="false">App spec
                    </button>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab"
                     tabindex="0">
                    <h2 class="mt-3">{{app_details.description}}</h2>
                    {{app_details.quill_description|safe}}
                </div>
                <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab"
                     tabindex="0">
                    <div class="card mt-3">
                        <img src="https://images.sftcdn.net/images/t_app-cover-s,f_auto/p/3e3e237f-1ec0-428e-a714-7281e181311e/2254899494/ssuite-netsurfer-browser-SSuite%20NetSurfer%20Browser-2.png"
                             class="card-img-top p-3 rounded" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">App specs</h5>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                Platform<br>
                                <span class="fw-bold"><small>Android</small></span>
                            </li>
                            <li class="list-group-item">
                                OS<br>
                                <span class="fw-bold"><small>Android</small></span>
                            </li>
                            <li class="list-group-item">
                                Language<br>
                                <span class="fw-bold"><small>English</small></span>
                            </li>
                            <li class="list-group-item">
                                Downloads<br>
                                <span class="fw-bold"><small>2k</small></span>
                            </li>
                            <li class="list-group-item">
                                Developer<br>
                                <span class="fw-bold"><small>2k</small></span>
                            </li>
                        </ul>
                        <!--                  <div class="card-body">-->
                        <!--                    <a href="#" class="card-link">Card link</a>-->
                        <!--                    <a href="#" class="card-link">Another link</a>-->
                        <!--                  </div>-->
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 mt-4">
            <h4 class="mb-4">Top download</h4>
            <div class="card">
                <div class="card-body text-center">
                    <div>
                        <table class="table table-hover">
                            <tbody>
                            {% for app in android_apps | sort(attribute='download_count', reverse=true)%}
                            <tr>
                                <th scope="row">
                                    <img alt="{{app.title}}"
                                         class="pe-2"
                                         src="{{ app.image_url }}"
                                         width="50">
                                </th>
                                <td>
                                    {{app.title}}
                                </td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <a class="btn btn-outline-dark mt-3 px-5" href="#">View all</a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-9 mt-5">
            <div class="row">
                <div class="col">
                    <div class="card border-success mb-3" style="width: 20rem;">
                        <div class="card-header text-success">
                            PROS
                        </div>
                        <ul class="list-group list-group-flush ">
                            <li class="list-group-item text-success">An item</li>
                            <li class="list-group-item text-success">A second item</li>
                            <li class="list-group-item text-success">A third item</li>
                        </ul>
                    </div>
                </div>
                <div class="col">
                    <div class="card border-danger mb-3" style="width: 20rem;">
                        <div class="card-header text-danger">
                            CONS
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item text-danger">An item</li>
                            <li class="list-group-item text-danger">A second item</li>
                            <li class="list-group-item text-danger">A third item</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3"></div>
    </div>

    <h5 class="mt-5">Explorer</h5>
    <div class="row g-2">
        {% for app in android_apps %}
        <div class="col-lg-3">
            <div class="card">
                <img src="{{ app.image_url }}" class="card-img-top p-5" alt="...">
                <div class="card-body">
                    <h6 class="card-title text-truncate">{{ app.title }}</h6>
                    <p class="card-text text-truncate">{{ app.description }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <section>
        <div class="container pt-5 ">
            <h4 class="mb-3">Article</h4>
            <div class="row mb-3 g-3">
                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/08/CC_1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">Unlock a Year of Premium Features for Just $1 with CCleaner
                                Professional!
                            </h4>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/09/Untitled-2-1024x576-1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">
                                AirTag: from finding the keys to locking up criminals
                            </h4>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/08/CC_1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">Unlock a Year of Premium Features for Just $1 with CCleaner
                                Professional!
                            </h4>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/09/Untitled-2-1024x576-1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">
                                AirTag: from finding the keys to locking up criminals
                            </h4>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/08/CC_1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">Unlock a Year of Premium Features for Just $1 with CCleaner
                                Professional!
                            </h4>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <img alt="..."
                             class="card-img-top" loading="lazy"
                             src="https://articles-img.sftcdn.net/f_auto,t_article_cover_xl/auto-mapping-folder/sites/3/2023/09/Untitled-2-1024x576-1.jpg">
                        <div class="card-body">
                            <h4 class="card-title">
                                AirTag: from finding the keys to locking up criminals
                            </h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

{% include 'footer.html'%}


<script>
    // JavaScript code to make an AJAX request when the button is clicked
    document.getElementById("increaseDownloadButton").addEventListener("click", function () {
        // Extract the app title from the template variable
        var appTitle = "{{ app_details.title }}";
        var encodedAppTitle = encodeURIComponent(appTitle);

        // Send a POST request to the FastAPI endpoint to increase the download count
        fetch(`/android/increase-download-count/${encodedAppTitle}`, {
            method: "POST"
        })
            .then(response => {
                if (response.ok) {
                    // Optionally, you can update the UI to reflect the increased download count
                    alert(`Download count for ${appTitle} increased successfully.`);
                } else {
                    alert(`Failed to increase download count for ${appTitle}.`);
                }
            })
            .catch(error => {
                console.error("Error:", error);
                alert("An error occurred while increasing the download count.");
            });
    });
</script>
